How to create a CVS repository
Arnaud Desitter
July 2003

#1 Choose a machine with
- a permanent internet connection (if necessary)
- a running ssh (secure shell) server (sshd)
- cvs installed

The instructions below assume a unix like operating system.

#2 Create a local user (say childcvs)
- The password can be left undefined (set it to * in /etc/passwd or equivalent).  In such case, access can be granted either as root or by adding a public
  key in "$HOME/.ssh/authorized_keys".
- Create a minimal .cshrc if the login shell is csh or .profile if the login
  shell is sh.
  For instance (.cshrc):
setenv PATH /usr/bin:/bin
umask 022
- make sure that $HOME is properly backed up.

#3 Create a cvs directory
- Log as 'childcvs', type: cd $HOME; cvs -d$HOME/cvs init.
- Import the existing cvs data within $HOME/cvs.

#4 Set up the ssh infrastructure
- create a directory $HOME/.ssh, make it "chmod 700".
- create a file $HOME/.ssh/authorized_keys.
  Type touch "$HOME/.ssh/authorized_keys; chmod 400 $HOME/.ssh/authorized_keys"

#5 Add ssh keys
- Add each ssh public key in $HOME/.ssh/authorized_keys on one line
  with the following model.

command="cvs server",no-port-forwarding,no-pty 1024 37 118080179148197043069420803161517313996529270621986287328230237252350379303806588690131831685012857735610665796603412358586879261970134845686207958276042873453671699266753114292283851643959898603905204263653754412078340524403985194797803688077717714923319067042 foo@bar

(see 'man sshd', section 'AUTHORIZED_KEYS FILE FORMAT')
The above line grant an access for the user having the associated private key.
The only usable command is "cvs server", which provides a reasonably good
safety.

#6 Test the cvs connection logged as a different user following the
instructions of get_snapshot.txt.

